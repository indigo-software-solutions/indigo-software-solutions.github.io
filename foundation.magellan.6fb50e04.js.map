{"version":3,"sources":["bower_components/foundation/js/foundation/foundation.magellan.js"],"names":["$","window","document","undefined","Foundation","libs","name","version","settings","active_class","threshold","destination_threshold","throttle_delay","fixed_top","offset_by_height","duration","easing","init","scope","method","options","inherit","bindings","events","self","S","set_expedition_position","off","on","add_namespace","e","sameHost","hostname","location","samePath","filterPathname","pathname","testHash","hash","replace","anchor","preventDefault","expedition","closest","attr_name","data","split","join","target","length","scroll_top","offset","top","outerHeight","stop","animate","history","pushState","search","throttle","check_for_arrivals","bind","update_arrivals","update_expedition_positions","each","idx","el","styles","attr","top_offset","parseInt","isNaN","data_attr","window_top_offset","scrollTop","placeholder","prev","clone","removeAttr","before","css","position","addClass","remove","removeClass","offsets","arrivals","find","active_item","item","viewport_offset","not","arrival","window_offset","map","dest","Math","floor","destination","sort","a","b","str","namespace","reflow","jQuery"],"mappings":"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","file":"foundation.magellan.6fb50e04.js","sourceRoot":"../app","sourcesContent":[";(function ($, window, document, undefined) {\n  'use strict';\n\n  Foundation.libs['magellan-expedition'] = {\n    name : 'magellan-expedition',\n\n    version : '5.5.3',\n\n    settings : {\n      active_class : 'active',\n      threshold : 0, // pixels from the top of the expedition for it to become fixes\n      destination_threshold : 20, // pixels from the top of destination for it to be considered active\n      throttle_delay : 30, // calculation throttling to increase framerate\n      fixed_top : 0, // top distance in pixels assigend to the fixed element on scroll\n      offset_by_height : true,  // whether to offset the destination by the expedition height. Usually you want this to be true, unless your expedition is on the side.\n      duration : 700, // animation duration time\n      easing : 'swing' // animation easing\n    },\n\n    init : function (scope, method, options) {\n      Foundation.inherit(this, 'throttle');\n      this.bindings(method, options);\n    },\n\n    events : function () {\n      var self = this,\n          S = self.S,\n          settings = self.settings;\n\n      // initialize expedition offset\n      self.set_expedition_position();\n\n      S(self.scope)\n        .off('.magellan')\n        .on('click.fndtn.magellan', '[' + self.add_namespace('data-magellan-arrival') + '] a[href*=#]', function (e) {\n          var sameHost = ((this.hostname === location.hostname) || !this.hostname),\n              samePath = self.filterPathname(location.pathname) === self.filterPathname(this.pathname),\n              testHash = this.hash.replace(/(:|\\.|\\/)/g, '\\\\$1'),\n              anchor = this;\n\n          if (sameHost && samePath && testHash) {\n            e.preventDefault();\n            var expedition = $(this).closest('[' + self.attr_name() + ']'),\n                settings = expedition.data('magellan-expedition-init'),\n                hash = this.hash.split('#').join(''),\n                target = $('a[name=\"' + hash + '\"]');\n\n            if (target.length === 0) {\n              target = $('#' + hash);\n\n            }\n\n            // Account for expedition height if fixed position\n            var scroll_top = target.offset().top - settings.destination_threshold + 1;\n            if (settings.offset_by_height) {\n              scroll_top = scroll_top - expedition.outerHeight();\n            }\n            $('html, body').stop().animate({\n              'scrollTop' : scroll_top\n            }, settings.duration, settings.easing, function () {\n              if (history.pushState) {\n                history.pushState(null, null, anchor.pathname + anchor.search + '#' + hash);\n              } else {\n                location.hash = anchor.pathname + anchor.search + '#' + hash;\n              }\n            });\n          }\n        })\n        .on('scroll.fndtn.magellan', self.throttle(this.check_for_arrivals.bind(this), settings.throttle_delay));\n    },\n\n    check_for_arrivals : function () {\n      var self = this;\n      self.update_arrivals();\n      self.update_expedition_positions();\n    },\n\n    set_expedition_position : function () {\n      var self = this;\n      $('[' + this.attr_name() + '=fixed]', self.scope).each(function (idx, el) {\n        var expedition = $(this),\n            settings = expedition.data('magellan-expedition-init'),\n            styles = expedition.attr('styles'), // save styles\n            top_offset, fixed_top;\n\n        expedition.attr('style', '');\n        top_offset = expedition.offset().top + settings.threshold;\n\n        //set fixed-top by attribute\n        fixed_top = parseInt(expedition.data('magellan-fixed-top'));\n        if (!isNaN(fixed_top)) {\n          self.settings.fixed_top = fixed_top;\n        }\n\n        expedition.data(self.data_attr('magellan-top-offset'), top_offset);\n        expedition.attr('style', styles);\n      });\n    },\n\n    update_expedition_positions : function () {\n      var self = this,\n          window_top_offset = $(window).scrollTop();\n\n      $('[' + this.attr_name() + '=fixed]', self.scope).each(function () {\n        var expedition = $(this),\n            settings = expedition.data('magellan-expedition-init'),\n            styles = expedition.attr('style'), // save styles\n            top_offset = expedition.data('magellan-top-offset');\n\n        //scroll to the top distance\n        if (window_top_offset + self.settings.fixed_top >= top_offset) {\n          // Placeholder allows height calculations to be consistent even when\n          // appearing to switch between fixed/non-fixed placement\n          var placeholder = expedition.prev('[' + self.add_namespace('data-magellan-expedition-clone') + ']');\n          if (placeholder.length === 0) {\n            placeholder = expedition.clone();\n            placeholder.removeAttr(self.attr_name());\n            placeholder.attr(self.add_namespace('data-magellan-expedition-clone'), '');\n            expedition.before(placeholder);\n          }\n          expedition.css({position :'fixed', top : settings.fixed_top}).addClass('fixed');\n        } else {\n          expedition.prev('[' + self.add_namespace('data-magellan-expedition-clone') + ']').remove();\n          expedition.attr('style', styles).css('position', '').css('top', '').removeClass('fixed');\n        }\n      });\n    },\n\n    update_arrivals : function () {\n      var self = this,\n          window_top_offset = $(window).scrollTop();\n\n      $('[' + this.attr_name() + ']', self.scope).each(function () {\n        var expedition = $(this),\n            settings = expedition.data(self.attr_name(true) + '-init'),\n            offsets = self.offsets(expedition, window_top_offset),\n            arrivals = expedition.find('[' + self.add_namespace('data-magellan-arrival') + ']'),\n            active_item = false;\n        offsets.each(function (idx, item) {\n          if (item.viewport_offset >= item.top_offset) {\n            var arrivals = expedition.find('[' + self.add_namespace('data-magellan-arrival') + ']');\n            arrivals.not(item.arrival).removeClass(settings.active_class);\n            item.arrival.addClass(settings.active_class);\n            active_item = true;\n            return true;\n          }\n        });\n\n        if (!active_item) {\n          arrivals.removeClass(settings.active_class);\n        }\n      });\n    },\n\n    offsets : function (expedition, window_offset) {\n      var self = this,\n          settings = expedition.data(self.attr_name(true) + '-init'),\n          viewport_offset = window_offset;\n\n      return expedition.find('[' + self.add_namespace('data-magellan-arrival') + ']').map(function (idx, el) {\n        var name = $(this).data(self.data_attr('magellan-arrival')),\n            dest = $('[' + self.add_namespace('data-magellan-destination') + '=' + name + ']');\n        if (dest.length > 0) {\n          var top_offset = dest.offset().top - settings.destination_threshold;\n          if (settings.offset_by_height) {\n            top_offset = top_offset - expedition.outerHeight();\n          }\n          top_offset = Math.floor(top_offset);\n          return {\n            destination : dest,\n            arrival : $(this),\n            top_offset : top_offset,\n            viewport_offset : viewport_offset\n          }\n        }\n      }).sort(function (a, b) {\n        if (a.top_offset < b.top_offset) {\n          return -1;\n        }\n        if (a.top_offset > b.top_offset) {\n          return 1;\n        }\n        return 0;\n      });\n    },\n\n    data_attr : function (str) {\n      if (this.namespace.length > 0) {\n        return this.namespace + '-' + str;\n      }\n\n      return str;\n    },\n\n    off : function () {\n      this.S(this.scope).off('.magellan');\n      this.S(window).off('.magellan');\n    },\n\n    filterPathname : function (pathname) {\n      pathname = pathname || '';\n      return pathname\n          .replace(/^\\//,'')\n          .replace(/(?:index|default).[a-zA-Z]{3,4}$/,'')\n          .replace(/\\/$/,'');\n    },\n\n    reflow : function () {\n      var self = this;\n      // remove placeholder expeditions used for height calculation purposes\n      $('[' + self.add_namespace('data-magellan-expedition-clone') + ']', self.scope).remove();\n    }\n  };\n}(jQuery, window, window.document));\n"]}