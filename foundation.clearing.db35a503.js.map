{"version":3,"sources":["bower_components/foundation/js/foundation/foundation.clearing.js"],"names":["$","window","document","undefined","Foundation","libs","clearing","name","version","settings","templates","viewing","close_selectors","open_selectors","skip_selector","touch_label","init","locked","scope","method","options","self","inherit","bindings","S","is","attr_name","assemble","each","events","$scroll_container","length","off","on","e","current","target","next","closest","data","image","preventDefault","hasClass","is_open","open","update_paddles","nav","close","keydown","resize","swipe_events","touches","originalEvent","start_page_x","pageX","start_page_y","pageY","start_time","Date","getTime","delta_x","is_scrolling","stopPropagation","scale","rtl","Math","abs","active","direction","$li","$el","parent","after","grid","detach","grid_outerHTML","outerHTML","holder","wrapper","Modernizr","touch","find","html","end","remove","$image","body","root","container","first","visible_image","not","label","error","loaded","trigger","load","interchange","attr","foundation","src","css","startLoad","setTimeout","image_loaded","outerWidth","cb","addClass","show","fix_height","caption","center_and_label","shift","siblings","removeClass","call","bind","el","test","selector","prev_index","hide","prop","NEXT_KEY","PREV_KEY","which","go","lis","children","li","height","outerHeight","width","prev","marginLeft","marginTop","marginRight","left","right","href","closest_a","nodeName","preload","img","sibling_type","preload_img","new_a","get","innerHTML","text","$ul","callback","skip_shift","old_index","index","dir","parseInt","dir_obj","up_count","lock","animate","unlock","response","li_width","floor","target_index","adjacent","current_index","i","reflow","jQuery"],"mappings":"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","file":"foundation.clearing.db35a503.js","sourceRoot":"../app","sourcesContent":[";(function ($, window, document, undefined) {\n  'use strict';\n\n  Foundation.libs.clearing = {\n    name : 'clearing',\n\n    version : '5.5.3',\n\n    settings : {\n      templates : {\n        viewing : '<a href=\"#\" class=\"clearing-close\">&times;</a>' +\n          '<div class=\"visible-img\" style=\"display: none\"><div class=\"clearing-touch-label\"></div><img src=\"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs%3D\" alt=\"\" />' +\n          '<p class=\"clearing-caption\"></p><a href=\"#\" class=\"clearing-main-prev\"><span></span></a>' +\n          '<a href=\"#\" class=\"clearing-main-next\"><span></span></a></div>' +\n          '<img class=\"clearing-preload-next\" style=\"display: none\" src=\"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs%3D\" alt=\"\" />' +\n          '<img class=\"clearing-preload-prev\" style=\"display: none\" src=\"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs%3D\" alt=\"\" />'\n      },\n\n      // comma delimited list of selectors that, on click, will close clearing,\n      // add 'div.clearing-blackout, div.visible-img' to close on background click\n      close_selectors : '.clearing-close, div.clearing-blackout',\n\n      // Default to the entire li element.\n      open_selectors : '',\n\n      // Image will be skipped in carousel.\n      skip_selector : '',\n\n      touch_label : '',\n\n      // event initializer and locks\n      init : false,\n      locked : false\n    },\n\n    init : function (scope, method, options) {\n      var self = this;\n      Foundation.inherit(this, 'throttle image_loaded');\n\n      this.bindings(method, options);\n\n      if (self.S(this.scope).is('[' + this.attr_name() + ']')) {\n        this.assemble(self.S('li', this.scope));\n      } else {\n        self.S('[' + this.attr_name() + ']', this.scope).each(function () {\n          self.assemble(self.S('li', this));\n        });\n      }\n    },\n\n    events : function (scope) {\n      var self = this,\n          S = self.S,\n          $scroll_container = $('.scroll-container');\n\n      if ($scroll_container.length > 0) {\n        this.scope = $scroll_container;\n      }\n\n      S(this.scope)\n        .off('.clearing')\n        .on('click.fndtn.clearing', 'ul[' + this.attr_name() + '] li ' + this.settings.open_selectors,\n          function (e, current, target) {\n            var current = current || S(this),\n                target = target || current,\n                next = current.next('li'),\n                settings = current.closest('[' + self.attr_name() + ']').data(self.attr_name(true) + '-init'),\n                image = S(e.target);\n\n            e.preventDefault();\n\n            if (!settings) {\n              self.init();\n              settings = current.closest('[' + self.attr_name() + ']').data(self.attr_name(true) + '-init');\n            }\n\n            // if clearing is open and the current image is\n            // clicked, go to the next image in sequence\n            if (target.hasClass('visible') &&\n              current[0] === target[0] &&\n              next.length > 0 && self.is_open(current)) {\n              target = next;\n              image = S('img', target);\n            }\n\n            // set current and target to the clicked li if not otherwise defined.\n            self.open(image, current, target);\n            self.update_paddles(target);\n          })\n\n        .on('click.fndtn.clearing', '.clearing-main-next',\n          function (e) { self.nav(e, 'next') })\n        .on('click.fndtn.clearing', '.clearing-main-prev',\n          function (e) { self.nav(e, 'prev') })\n        .on('click.fndtn.clearing', this.settings.close_selectors,\n          function (e) { Foundation.libs.clearing.close(e, this) });\n\n      $(document).on('keydown.fndtn.clearing',\n          function (e) { self.keydown(e) });\n\n      S(window).off('.clearing').on('resize.fndtn.clearing',\n        function () { self.resize() });\n\n      this.swipe_events(scope);\n    },\n\n    swipe_events : function (scope) {\n      var self = this,\n      S = self.S;\n\n      S(this.scope)\n        .on('touchstart.fndtn.clearing', '.visible-img', function (e) {\n          if (!e.touches) { e = e.originalEvent; }\n          var data = {\n                start_page_x : e.touches[0].pageX,\n                start_page_y : e.touches[0].pageY,\n                start_time : (new Date()).getTime(),\n                delta_x : 0,\n                is_scrolling : undefined\n              };\n\n          S(this).data('swipe-transition', data);\n          e.stopPropagation();\n        })\n        .on('touchmove.fndtn.clearing', '.visible-img', function (e) {\n          if (!e.touches) {\n            e = e.originalEvent;\n          }\n          // Ignore pinch/zoom events\n          if (e.touches.length > 1 || e.scale && e.scale !== 1) {\n            return;\n          }\n\n          var data = S(this).data('swipe-transition');\n\n          if (typeof data === 'undefined') {\n            data = {};\n          }\n\n          data.delta_x = e.touches[0].pageX - data.start_page_x;\n\n          if (Foundation.rtl) {\n            data.delta_x = -data.delta_x;\n          }\n\n          if (typeof data.is_scrolling === 'undefined') {\n            data.is_scrolling = !!( data.is_scrolling || Math.abs(data.delta_x) < Math.abs(e.touches[0].pageY - data.start_page_y) );\n          }\n\n          if (!data.is_scrolling && !data.active) {\n            e.preventDefault();\n            var direction = (data.delta_x < 0) ? 'next' : 'prev';\n            data.active = true;\n            self.nav(e, direction);\n          }\n        })\n        .on('touchend.fndtn.clearing', '.visible-img', function (e) {\n          S(this).data('swipe-transition', {});\n          e.stopPropagation();\n        });\n    },\n\n    assemble : function ($li) {\n      var $el = $li.parent();\n\n      if ($el.parent().hasClass('carousel')) {\n        return;\n      }\n\n      $el.after('<div id=\"foundationClearingHolder\"></div>');\n\n      var grid = $el.detach(),\n          grid_outerHTML = '';\n\n      if (grid[0] == null) {\n        return;\n      } else {\n        grid_outerHTML = grid[0].outerHTML;\n      }\n\n      var holder = this.S('#foundationClearingHolder'),\n          settings = $el.data(this.attr_name(true) + '-init'),\n          data = {\n            grid : '<div class=\"carousel\">' + grid_outerHTML + '</div>',\n            viewing : settings.templates.viewing\n          },\n          wrapper = '<div class=\"clearing-assembled\"><div>' + data.viewing +\n            data.grid + '</div></div>',\n          touch_label = this.settings.touch_label;\n\n      if (Modernizr.touch) {\n        wrapper = $(wrapper).find('.clearing-touch-label').html(touch_label).end();\n      }\n\n      holder.after(wrapper).remove();\n    },\n\n    open : function ($image, current, target) {\n      var self = this,\n          body = $(document.body),\n          root = target.closest('.clearing-assembled'),\n          container = self.S('div', root).first(),\n          visible_image = self.S('.visible-img', container),\n          image = self.S('img', visible_image).not($image),\n          label = self.S('.clearing-touch-label', container),\n          error = false,\n          loaded = {};\n\n      // Event to disable scrolling on touch devices when Clearing is activated\n      $('body').on('touchmove', function (e) {\n        e.preventDefault();\n      });\n\n      image.error(function () {\n        error = true;\n      });\n\n      function startLoad() {\n        setTimeout(function () {\n          this.image_loaded(image, function () {\n            if (image.outerWidth() === 1 && !error) {\n              startLoad.call(this);\n            } else {\n              cb.call(this, image);\n            }\n          }.bind(this));\n        }.bind(this), 100);\n      }\n\n      function cb (image) {\n        var $image = $(image);\n        $image.css('visibility', 'visible');\n        $image.trigger('imageVisible');\n        // toggle the gallery\n        body.css('overflow', 'hidden');\n        root.addClass('clearing-blackout');\n        container.addClass('clearing-container');\n        visible_image.show();\n        this.fix_height(target)\n          .caption(self.S('.clearing-caption', visible_image), self.S('img', target))\n          .center_and_label(image, label)\n          .shift(current, target, function () {\n            target.closest('li').siblings().removeClass('visible');\n            target.closest('li').addClass('visible');\n          });\n        visible_image.trigger('opened.fndtn.clearing')\n      }\n\n      if (!this.locked()) {\n        visible_image.trigger('open.fndtn.clearing');\n        // set the image to the selected thumbnail\n        loaded = this.load($image);\n        if (loaded.interchange) {\n          image\n            .attr('data-interchange', loaded.interchange)\n            .foundation('interchange', 'reflow');\n        } else {\n          image\n            .attr('src', loaded.src)\n            .attr('data-interchange', '');\n        }\n        image.css('visibility', 'hidden');\n\n        startLoad.call(this);\n      }\n    },\n\n    close : function (e, el) {\n      e.preventDefault();\n\n      var root = (function (target) {\n            if (/blackout/.test(target.selector)) {\n              return target;\n            } else {\n              return target.closest('.clearing-blackout');\n            }\n          }($(el))),\n          body = $(document.body), container, visible_image;\n\n      if (el === e.target && root) {\n        body.css('overflow', '');\n        container = $('div', root).first();\n        visible_image = $('.visible-img', container);\n        visible_image.trigger('close.fndtn.clearing');\n        this.settings.prev_index = 0;\n        $('ul[' + this.attr_name() + ']', root)\n          .attr('style', '').closest('.clearing-blackout')\n          .removeClass('clearing-blackout');\n        container.removeClass('clearing-container');\n        visible_image.hide();\n        visible_image.trigger('closed.fndtn.clearing');\n      }\n\n      // Event to re-enable scrolling on touch devices\n      $('body').off('touchmove');\n\n      return false;\n    },\n\n    is_open : function (current) {\n      return current.parent().prop('style').length > 0;\n    },\n\n    keydown : function (e) {\n      var clearing = $('.clearing-blackout ul[' + this.attr_name() + ']'),\n          NEXT_KEY = this.rtl ? 37 : 39,\n          PREV_KEY = this.rtl ? 39 : 37,\n          ESC_KEY = 27;\n\n      if (e.which === NEXT_KEY) {\n        this.go(clearing, 'next');\n      }\n      if (e.which === PREV_KEY) {\n        this.go(clearing, 'prev');\n      }\n      if (e.which === ESC_KEY) {\n        this.S('a.clearing-close').trigger('click.fndtn.clearing');\n      }\n    },\n\n    nav : function (e, direction) {\n      var clearing = $('ul[' + this.attr_name() + ']', '.clearing-blackout');\n\n      e.preventDefault();\n      this.go(clearing, direction);\n    },\n\n    resize : function () {\n      var image = $('img', '.clearing-blackout .visible-img'),\n          label = $('.clearing-touch-label', '.clearing-blackout');\n\n      if (image.length) {\n        this.center_and_label(image, label);\n        image.trigger('resized.fndtn.clearing')\n      }\n    },\n\n    // visual adjustments\n    fix_height : function (target) {\n      var lis = target.parent().children(),\n          self = this;\n\n      lis.each(function () {\n        var li = self.S(this),\n            image = li.find('img');\n\n        if (li.height() > image.outerHeight()) {\n          li.addClass('fix-height');\n        }\n      })\n      .closest('ul')\n      .width(lis.length * 100 + '%');\n\n      return this;\n    },\n\n    update_paddles : function (target) {\n      target = target.closest('li');\n      var visible_image = target\n        .closest('.carousel')\n        .siblings('.visible-img');\n\n      if (target.next().length > 0) {\n        this.S('.clearing-main-next', visible_image).removeClass('disabled');\n      } else {\n        this.S('.clearing-main-next', visible_image).addClass('disabled');\n      }\n\n      if (target.prev().length > 0) {\n        this.S('.clearing-main-prev', visible_image).removeClass('disabled');\n      } else {\n        this.S('.clearing-main-prev', visible_image).addClass('disabled');\n      }\n    },\n\n    center_and_label : function (target, label) {\n      if (!this.rtl && label.length > 0) {\n        label.css({\n          marginLeft : -(label.outerWidth() / 2),\n          marginTop : -(target.outerHeight() / 2)-label.outerHeight()-10\n        });\n      } else {\n        label.css({\n          marginRight : -(label.outerWidth() / 2),\n          marginTop : -(target.outerHeight() / 2)-label.outerHeight()-10,\n          left: 'auto',\n          right: '50%'\n        });\n      }\n      return this;\n    },\n\n    // image loading and preloading\n\n    load : function ($image) {\n      var href,\n          interchange,\n          closest_a;\n\n      if ($image[0].nodeName === 'A') {\n        href = $image.attr('href');\n        interchange = $image.data('clearing-interchange');\n      } else {\n        closest_a = $image.closest('a');\n        href = closest_a.attr('href');\n        interchange = closest_a.data('clearing-interchange');\n      }\n\n      this.preload($image);\n\n      return {\n        'src': href ? href : $image.attr('src'),\n        'interchange': href ? interchange : $image.data('clearing-interchange')\n      }\n    },\n\n    preload : function ($image) {\n      this\n        .img($image.closest('li').next(), 'next')\n        .img($image.closest('li').prev(), 'prev');\n    },\n\n    img : function (img, sibling_type) {\n      if (img.length) {\n        var preload_img = $('.clearing-preload-' + sibling_type),\n            new_a = this.S('a', img),\n            src,\n            interchange,\n            image;\n\n        if (new_a.length) {\n          src = new_a.attr('href');\n          interchange = new_a.data('clearing-interchange');\n        } else {\n          image = this.S('img', img);\n          src = image.attr('src');\n          interchange = image.data('clearing-interchange');\n        }\n\n        if (interchange) {\n          preload_img.attr('data-interchange', interchange);\n        } else {\n          preload_img.attr('src', src);\n          preload_img.attr('data-interchange', '');\n        }\n      }\n      return this;\n    },\n\n    // image caption\n\n    caption : function (container, $image) {\n      var caption = $image.attr('data-caption');\n\n      if (caption) {\n      \tvar containerPlain = container.get(0);\n      \tcontainerPlain.innerHTML = caption;\n        container.show();\n      } else {\n        container\n          .text('')\n          .hide();\n      }\n      return this;\n    },\n\n    // directional methods\n\n    go : function ($ul, direction) {\n      var current = this.S('.visible', $ul),\n          target = current[direction]();\n\n      // Check for skip selector.\n      if (this.settings.skip_selector && target.find(this.settings.skip_selector).length != 0) {\n        target = target[direction]();\n      }\n\n      if (target.length) {\n        this.S('img', target)\n          .trigger('click.fndtn.clearing', [current, target])\n          .trigger('change.fndtn.clearing');\n      }\n    },\n\n    shift : function (current, target, callback) {\n      var clearing = target.parent(),\n          old_index = this.settings.prev_index || target.index(),\n          direction = this.direction(clearing, current, target),\n          dir = this.rtl ? 'right' : 'left',\n          left = parseInt(clearing.css('left'), 10),\n          width = target.outerWidth(),\n          skip_shift;\n\n      var dir_obj = {};\n\n      // we use jQuery animate instead of CSS transitions because we\n      // need a callback to unlock the next animation\n      // needs support for RTL **\n      if (target.index() !== old_index && !/skip/.test(direction)) {\n        if (/left/.test(direction)) {\n          this.lock();\n          dir_obj[dir] = left + width;\n          clearing.animate(dir_obj, 300, this.unlock());\n        } else if (/right/.test(direction)) {\n          this.lock();\n          dir_obj[dir] = left - width;\n          clearing.animate(dir_obj, 300, this.unlock());\n        }\n      } else if (/skip/.test(direction)) {\n        // the target image is not adjacent to the current image, so\n        // do we scroll right or not\n        skip_shift = target.index() - this.settings.up_count;\n        this.lock();\n\n        if (skip_shift > 0) {\n          dir_obj[dir] = -(skip_shift * width);\n          clearing.animate(dir_obj, 300, this.unlock());\n        } else {\n          dir_obj[dir] = 0;\n          clearing.animate(dir_obj, 300, this.unlock());\n        }\n      }\n\n      callback();\n    },\n\n    direction : function ($el, current, target) {\n      var lis = this.S('li', $el),\n          li_width = lis.outerWidth() + (lis.outerWidth() / 4),\n          up_count = Math.floor(this.S('.clearing-container').outerWidth() / li_width) - 1,\n          target_index = lis.index(target),\n          response;\n\n      this.settings.up_count = up_count;\n\n      if (this.adjacent(this.settings.prev_index, target_index)) {\n        if ((target_index > up_count) && target_index > this.settings.prev_index) {\n          response = 'right';\n        } else if ((target_index > up_count - 1) && target_index <= this.settings.prev_index) {\n          response = 'left';\n        } else {\n          response = false;\n        }\n      } else {\n        response = 'skip';\n      }\n\n      this.settings.prev_index = target_index;\n\n      return response;\n    },\n\n    adjacent : function (current_index, target_index) {\n      for (var i = target_index + 1; i >= target_index - 1; i--) {\n        if (i === current_index) {\n          return true;\n        }\n      }\n      return false;\n    },\n\n    // lock management\n\n    lock : function () {\n      this.settings.locked = true;\n    },\n\n    unlock : function () {\n      this.settings.locked = false;\n    },\n\n    locked : function () {\n      return this.settings.locked;\n    },\n\n    off : function () {\n      this.S(this.scope).off('.fndtn.clearing');\n      this.S(window).off('.fndtn.clearing');\n    },\n\n    reflow : function () {\n      this.init();\n    }\n  };\n\n}(jQuery, window, window.document));\n"]}